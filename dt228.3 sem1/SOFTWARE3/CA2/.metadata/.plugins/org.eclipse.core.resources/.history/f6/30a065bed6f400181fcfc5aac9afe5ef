package com.example.command;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.example.business.student;
import com.example.command.CheckStudentCommand;
import com.example.service.StudentService;
import com.example.service.libraryService;
import com.example.business.library;

public class BorrowCommand implements Command {
StudentService students = new StudentService();
libraryService librarys = new libraryService();
	@Override
	public String execute(HttpServletRequest request, HttpServletResponse repsonse){
		HttpSession session = request.getSession();
		String bookid = request.getParameter("borrowId");
		int bookst = Integer.parseInt(request.getParameter("bookStock"));
		String forwardToJsp = "";		
		student info = (student) session.getAttribute("student");
		String borrowed = info.getBorrow(); 
		String studentId = info.getId();
		String studentName = info.getStudentName();
		
		
        if(borrowed.equals("F"))
        {
        
        	students.goBorrow(studentId);
            librarys.Borrowbook(studentName,bookst, bookid);
            borrowed = "T";
        }
        else
        {
        
        	System.out.print("can not borrow more then one book");
        }
		forwardToJsp = "/library.jsp";
		
		
		return forwardToJsp;
	}

}
